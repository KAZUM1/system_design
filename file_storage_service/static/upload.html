""<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–µ–≥–∞-–î–∏—Å–∫</title>
    <style>
        body {
            background-color: #121212;
            color: #ffffff;
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            padding: 20px;
        }
        header {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            background-color: #1e1e1e;
            box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #ffcc00;
            margin: 0;
        }
        .container {
            width: 80%;
            max-width: 800px;
            text-align: center;
            margin-top: 20px;
        }
        .file-input {
            margin: 20px 0;
        }
        .button {
            background-color: #ffcc00;
            border: none;
            padding: 10px 15px;
            cursor: pointer;
            font-size: 16px;
            color: #121212;
            border-radius: 5px;
            margin: 5px;
        }
        .button:hover {
            background-color: #e6b800;
        }
        .file-list, .folder-list {
            width: 100%;
            text-align: left;
            margin-top: 20px;
        }
        .file, .folder {
            padding: 10px;
            background-color: #1e1e1e;
            margin: 5px 0;
            border-radius: 5px;
            cursor: pointer;
        }
        .file:hover, .folder:hover {
            background-color: #2c2c2c;
        }
        .preview {
            margin-top: 20px;
            display: none;
            text-align: center;
        }
        .preview img {
            max-width: 100%;
            max-height: 400px;
            border-radius: 5px;
        }
    </style>
</head>
<body>

<header>
    <h1>–ú–µ–≥–∞-–î–∏—Å–∫</h1>
</header>

<div class="container">
    <h2>–ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤–∞—à —Ñ–∞–π–ª</h2>
    <input type="file" id="fileInput" class="file-input">
    <button class="button" onclick="uploadFile()">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>

    <h2>–°–æ–∑–¥–∞—Ç—å –ø–∞–ø–∫—É</h2>
    <input type="text" id="folderName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –ø–∞–ø–∫–∏">
    <button class="button" onclick="createFolder()">–°–æ–∑–¥–∞—Ç—å</button>

    <h2>–í–∞—à–∏ —Ñ–∞–π–ª—ã –∏ –ø–∞–ø–∫–∏</h2>
    <div class="folder-list" id="folderList"></div>
    <div class="file-list" id="fileList"></div>

    <div class="preview" id="preview">
        <h3>–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</h3>
        <img id="previewImg" src="" alt="–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä">
        <p id="previewText"></p>
    </div>
</div>

<script>
    let files = [];
    let folders = [];

    async function uploadFile() {
        const input = document.getElementById('fileInput');
        if (input.files.length === 0) return alert("–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª!");

        const file = input.files[0];
        const formData = new FormData();
        formData.append("file", file);

        try {
            const response = await fetch("http://127.0.0.1:8000/files/folders/root", {
                method: "POST",
                body: formData
            });

            if (response.ok) {
                alert("–§–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω!");
                loadFiles(); // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤
            } else {
                alert("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏!");
            }
        } catch (error) {
            console.error("–û—à–∏–±–∫–∞:", error);
        }
}


    async function createFolder() {
        const input = document.getElementById('folderName');
        const folderName = input.value.trim();
        if (!folderName) return alert("–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–∞–ø–∫–∏!");

        try {
            const response = await fetch("http://127.0.0.1:8000/files/folders", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ name: folderName })
            });

            if (response.ok) {
                alert("–ü–∞–ø–∫–∞ —Å–æ–∑–¥–∞–Ω–∞!");
                loadFiles(); // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫
            } else {
                alert("–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–∞–ø–∫–∏!");
            }
        } catch (error) {
            console.error("–û—à–∏–±–∫–∞:", error);
        }
    }


    async function loadFiles() {
        try {
            const response = await fetch("http://127.0.0.1:8000/files/folders");
            const data = await response.json();
            
            const fileList = document.getElementById('fileList');
            const folderList = document.getElementById('folderList');

            fileList.innerHTML = '';
            folderList.innerHTML = '';

            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –ø–∞–ø–∫–∏ üìÅ
            data.folders.forEach(folder => {
                const item = document.createElement('div');
                item.className = 'folder';
                item.textContent = `üìÅ ${folder}`;
                folderList.appendChild(item);
            });

            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ñ–∞–π–ª—ã üìÑ
            data.files.forEach(file => {
                const item = document.createElement('div');
                item.className = 'file';
                item.textContent = `üìÑ ${file.name}`;
                item.onclick = () => previewFile(file.url); // –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–∏ –∫–ª–∏–∫–µ
                fileList.appendChild(item);
            });
        } catch (error) {
            console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤:", error);
        }
}


// –í—ã–∑—ã–≤–∞–µ–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
loadFiles();


    function updateFolderList() {
        const list = document.getElementById('folderList');
        list.innerHTML = '';
        folders.forEach((folder, index) => {
            const item = document.createElement('div');
            item.className = 'folder';
            item.textContent = folder;
            list.appendChild(item);
        });
    }

    function previewFile(fileUrl) {
        const preview = document.getElementById('preview');
        const previewImg = document.getElementById('previewImg');
        const previewText = document.getElementById('previewText');

        if (fileUrl.endsWith('.png') || fileUrl.endsWith('.jpg') || fileUrl.endsWith('.jpeg')) {
            previewImg.src = fileUrl;
            previewImg.style.display = 'block';
            previewText.style.display = 'none';
        } else {
            previewText.textContent = `–§–∞–π–ª: ${fileUrl}`;
            previewImg.style.display = 'none';
            previewText.style.display = 'block';
        }
        
        preview.style.display = 'block';
}

</script>

</body>
</html>""
